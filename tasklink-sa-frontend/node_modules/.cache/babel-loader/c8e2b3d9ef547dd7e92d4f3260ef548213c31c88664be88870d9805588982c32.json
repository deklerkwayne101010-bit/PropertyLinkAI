{"ast":null,"code":"var _jsxFileName = \"c:\\\\Users\\\\owner\\\\OneDrive - Process Steel\\\\Documents\\\\GitHub\\\\bolt.diy\\\\tasklink-sa-frontend\\\\src\\\\index.tsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect } from 'react';\nimport ReactDOM from 'react-dom/client';\nimport { Provider, useDispatch } from 'react-redux';\nimport { CircularProgress, Box } from '@mui/material';\nimport App from './App';\nimport { store } from './store/store';\nimport { initializeAuth } from './store/slices/authSlice';\nimport { getStoredToken, isTokenExpired } from './utils/auth';\n\n// Auth initializer component\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst AuthInitializer = ({\n  children\n}) => {\n  _s();\n  const dispatch = useDispatch();\n  const [isInitializing, setIsInitializing] = React.useState(true);\n  useEffect(() => {\n    const initializeAuthState = async () => {\n      try {\n        const token = getStoredToken();\n        if (token && !isTokenExpired(token)) {\n          // For now, we'll initialize with basic user info from token\n          // In a production app, you might want to validate with the server\n          const payload = JSON.parse(atob(token.split('.')[1]));\n          const user = {\n            id: payload.userId || payload.sub,\n            email: payload.email,\n            name: payload.name || payload.email,\n            role: payload.role || 'task_doer'\n          };\n          dispatch(initializeAuth({\n            user,\n            token\n          }));\n        } else {\n          // No valid token found\n          dispatch(initializeAuth(null));\n        }\n      } catch (error) {\n        console.error('Auth initialization error:', error);\n        dispatch(initializeAuth(null));\n      } finally {\n        setIsInitializing(false);\n      }\n    };\n    initializeAuthState();\n  }, [dispatch]);\n  if (isInitializing) {\n    return /*#__PURE__*/_jsxDEV(Box, {\n      display: \"flex\",\n      justifyContent: \"center\",\n      alignItems: \"center\",\n      minHeight: \"100vh\",\n      sx: {\n        backgroundColor: '#f5f5f5'\n      },\n      children: /*#__PURE__*/_jsxDEV(CircularProgress, {\n        size: 60\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: children\n  }, void 0, false);\n};\n_s(AuthInitializer, \"/2acT0yR4bT7Sr6ayBFTYFmrBgI=\", false, function () {\n  return [useDispatch];\n});\n_c = AuthInitializer;\nconst root = ReactDOM.createRoot(document.getElementById('root'));\nroot.render(/*#__PURE__*/_jsxDEV(Provider, {\n  store: store,\n  children: /*#__PURE__*/_jsxDEV(AuthInitializer, {\n    children: /*#__PURE__*/_jsxDEV(App, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 70,\n    columnNumber: 5\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 69,\n  columnNumber: 3\n}, this));\nvar _c;\n$RefreshReg$(_c, \"AuthInitializer\");","map":{"version":3,"names":["React","useEffect","ReactDOM","Provider","useDispatch","CircularProgress","Box","App","store","initializeAuth","getStoredToken","isTokenExpired","jsxDEV","_jsxDEV","Fragment","_Fragment","AuthInitializer","children","_s","dispatch","isInitializing","setIsInitializing","useState","initializeAuthState","token","payload","JSON","parse","atob","split","user","id","userId","sub","email","name","role","error","console","display","justifyContent","alignItems","minHeight","sx","backgroundColor","size","fileName","_jsxFileName","lineNumber","columnNumber","_c","root","createRoot","document","getElementById","render","$RefreshReg$"],"sources":["c:/Users/owner/OneDrive - Process Steel/Documents/GitHub/bolt.diy/tasklink-sa-frontend/src/index.tsx"],"sourcesContent":["import React, { useEffect } from 'react';\r\nimport ReactDOM from 'react-dom/client';\r\nimport { Provider, useDispatch } from 'react-redux';\r\nimport { CircularProgress, Box } from '@mui/material';\r\nimport App from './App';\r\nimport { store } from './store/store';\r\nimport { initializeAuth } from './store/slices/authSlice';\r\nimport { getStoredToken, isTokenExpired, startTokenExpirationCheck } from './utils/auth';\r\n\r\n// Auth initializer component\r\nconst AuthInitializer: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n  const dispatch = useDispatch();\r\n  const [isInitializing, setIsInitializing] = React.useState(true);\r\n\r\n  useEffect(() => {\r\n    const initializeAuthState = async () => {\r\n      try {\r\n        const token = getStoredToken();\r\n\r\n        if (token && !isTokenExpired(token)) {\r\n          // For now, we'll initialize with basic user info from token\r\n          // In a production app, you might want to validate with the server\r\n          const payload = JSON.parse(atob(token.split('.')[1]));\r\n          const user = {\r\n            id: payload.userId || payload.sub,\r\n            email: payload.email,\r\n            name: payload.name || payload.email,\r\n            role: payload.role || 'task_doer'\r\n          };\r\n\r\n          dispatch(initializeAuth({ user, token }));\r\n        } else {\r\n          // No valid token found\r\n          dispatch(initializeAuth(null));\r\n        }\r\n      } catch (error) {\r\n        console.error('Auth initialization error:', error);\r\n        dispatch(initializeAuth(null));\r\n      } finally {\r\n        setIsInitializing(false);\r\n      }\r\n    };\r\n\r\n    initializeAuthState();\r\n  }, [dispatch]);\r\n\r\n  if (isInitializing) {\r\n    return (\r\n      <Box\r\n        display=\"flex\"\r\n        justifyContent=\"center\"\r\n        alignItems=\"center\"\r\n        minHeight=\"100vh\"\r\n        sx={{ backgroundColor: '#f5f5f5' }}\r\n      >\r\n        <CircularProgress size={60} />\r\n      </Box>\r\n    );\r\n  }\r\n\r\n  return <>{children}</>;\r\n};\r\n\r\nconst root = ReactDOM.createRoot(\r\n  document.getElementById('root') as HTMLElement\r\n);\r\n\r\nroot.render(\r\n  <Provider store={store}>\r\n    <AuthInitializer>\r\n      <App />\r\n    </AuthInitializer>\r\n  </Provider>\r\n);"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,QAAQ,OAAO;AACxC,OAAOC,QAAQ,MAAM,kBAAkB;AACvC,SAASC,QAAQ,EAAEC,WAAW,QAAQ,aAAa;AACnD,SAASC,gBAAgB,EAAEC,GAAG,QAAQ,eAAe;AACrD,OAAOC,GAAG,MAAM,OAAO;AACvB,SAASC,KAAK,QAAQ,eAAe;AACrC,SAASC,cAAc,QAAQ,0BAA0B;AACzD,SAASC,cAAc,EAAEC,cAAc,QAAmC,cAAc;;AAExF;AAAA,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AACA,MAAMC,eAAwD,GAAGA,CAAC;EAAEC;AAAS,CAAC,KAAK;EAAAC,EAAA;EACjF,MAAMC,QAAQ,GAAGf,WAAW,CAAC,CAAC;EAC9B,MAAM,CAACgB,cAAc,EAAEC,iBAAiB,CAAC,GAAGrB,KAAK,CAACsB,QAAQ,CAAC,IAAI,CAAC;EAEhErB,SAAS,CAAC,MAAM;IACd,MAAMsB,mBAAmB,GAAG,MAAAA,CAAA,KAAY;MACtC,IAAI;QACF,MAAMC,KAAK,GAAGd,cAAc,CAAC,CAAC;QAE9B,IAAIc,KAAK,IAAI,CAACb,cAAc,CAACa,KAAK,CAAC,EAAE;UACnC;UACA;UACA,MAAMC,OAAO,GAAGC,IAAI,CAACC,KAAK,CAACC,IAAI,CAACJ,KAAK,CAACK,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;UACrD,MAAMC,IAAI,GAAG;YACXC,EAAE,EAAEN,OAAO,CAACO,MAAM,IAAIP,OAAO,CAACQ,GAAG;YACjCC,KAAK,EAAET,OAAO,CAACS,KAAK;YACpBC,IAAI,EAAEV,OAAO,CAACU,IAAI,IAAIV,OAAO,CAACS,KAAK;YACnCE,IAAI,EAAEX,OAAO,CAACW,IAAI,IAAI;UACxB,CAAC;UAEDjB,QAAQ,CAACV,cAAc,CAAC;YAAEqB,IAAI;YAAEN;UAAM,CAAC,CAAC,CAAC;QAC3C,CAAC,MAAM;UACL;UACAL,QAAQ,CAACV,cAAc,CAAC,IAAI,CAAC,CAAC;QAChC;MACF,CAAC,CAAC,OAAO4B,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;QAClDlB,QAAQ,CAACV,cAAc,CAAC,IAAI,CAAC,CAAC;MAChC,CAAC,SAAS;QACRY,iBAAiB,CAAC,KAAK,CAAC;MAC1B;IACF,CAAC;IAEDE,mBAAmB,CAAC,CAAC;EACvB,CAAC,EAAE,CAACJ,QAAQ,CAAC,CAAC;EAEd,IAAIC,cAAc,EAAE;IAClB,oBACEP,OAAA,CAACP,GAAG;MACFiC,OAAO,EAAC,MAAM;MACdC,cAAc,EAAC,QAAQ;MACvBC,UAAU,EAAC,QAAQ;MACnBC,SAAS,EAAC,OAAO;MACjBC,EAAE,EAAE;QAAEC,eAAe,EAAE;MAAU,CAAE;MAAA3B,QAAA,eAEnCJ,OAAA,CAACR,gBAAgB;QAACwC,IAAI,EAAE;MAAG;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAC3B,CAAC;EAEV;EAEA,oBAAOpC,OAAA,CAAAE,SAAA;IAAAE,QAAA,EAAGA;EAAQ,gBAAG,CAAC;AACxB,CAAC;AAACC,EAAA,CAnDIF,eAAwD;EAAA,QAC3CZ,WAAW;AAAA;AAAA8C,EAAA,GADxBlC,eAAwD;AAqD9D,MAAMmC,IAAI,GAAGjD,QAAQ,CAACkD,UAAU,CAC9BC,QAAQ,CAACC,cAAc,CAAC,MAAM,CAChC,CAAC;AAEDH,IAAI,CAACI,MAAM,cACT1C,OAAA,CAACV,QAAQ;EAACK,KAAK,EAAEA,KAAM;EAAAS,QAAA,eACrBJ,OAAA,CAACG,eAAe;IAAAC,QAAA,eACdJ,OAAA,CAACN,GAAG;MAAAuC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACQ;AAAC;EAAAH,QAAA,EAAAC,YAAA;EAAAC,UAAA;EAAAC,YAAA;AAAA,OACV,CACZ,CAAC;AAAC,IAAAC,EAAA;AAAAM,YAAA,CAAAN,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}